generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id           String       @id @default(uuid())
  name         String
  email        String       @unique
  passwordHash String
  role         String       @default("user")
  memberships  Membership[]
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

model Order {
  id          String       @id @default(uuid())
  buyerName   String
  buyerEmail  String
  buyerData   Json?
  items       Json
  total       Float
  status      String       @default("pending")
  confirmedAt DateTime?
  memberships Membership[]
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model Membership {
  id             String   @id @default(uuid())
  order          Order?   @relation(fields: [orderId], references: [id])
  orderId        String?
  user           User?    @relation(fields: [userId], references: [id])
  userId         String?
  planKey        String
  activationCode String   @unique
  billing        String
  discountPercent Float
  startedAt      DateTime
  expiresAt      DateTime
  grantedAt      DateTime
  userEmail      String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Product {
  id       Int    @id
  name     String
  price    Float
  desc     String?
  image    String?
  images   Json?
  video    String?
}
